name: Run deck
on:
  push:
    branches:
      - 'main'
    paths-ignore:
      - '.github/**'
      - README.md 

jobs:
 deck-sync:
  runs-on: ubuntu-latest
  steps:
    - name: Setup decK
      uses: kong/setup-decK@v1
      with:
        deck-version: "1.8.0"
    - name: Clone repo
      uses: actions/checkout@v2
    - name: Run deck deck-sync
      run: decK sync --kong-addr ${{ secrets.KONG_ADMIN_API_URL }}
